终端规约开发说明 {#protocol-dev}
=============

modbus简单介绍查看参考文档8和9.

程序流程依照参考文档4.

主程序以动态加载动态库的方式调用本规约.

规约文本见参考文档.doc目录下有一些参考资料.若有冲突请以官方modbus/TCP说明书为准.modbus/TCP是通用协议.拥有自己的专属端口,但是我们终端还是使用默认10000以上的端口.

协议寄存器由开发者自行定义.本实现使用了32位单精度浮点型,IEEE 754 float格式.参考文档7可以用于开发调试时确认数据格式.由于标准modbus协议寄存器宽度为16字节,所以使用了2个寄存器传输一个浮点型数据.

本实现基本仅实现官方的读保持寄存器功能部分.任何对寄存器写操作都是无效的,且会返回功能代码不被支持的错误信息.

###对于寄存器的组织
寄存器地址16位,寄存器宽度16位.寄存器地址的高字节表示表号 0x00~0xFF,低字节表示某一表的具体物理量,如正向有功总电量等.本实现实现了读瞬时电量.都是由内存中直接读取的.必须与主程序定义完全对应.

###调试
utility目录下有主站和从站的仿真软件,是对于通用功能的.仿真软件仅仅用来验证报文结构的准确性.不包含任何业务逻辑.

工程可以用Qt-creator打开.也可以单独编辑,Linux下的Makefile保存了编译的步骤.

在终端启动主程序可以在标准输出中显示类似"参考报文"的打印信息.
